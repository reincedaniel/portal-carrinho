@@include("partials/main.html")

    <head>
        
        @@include("partials/title-meta.html", {"title": "Meu Perfil"})

        <!-- Choise Css -->
        <link rel="stylesheet" href="assets/libs/choices.js/public/assets/styles/choices.min.css">

        @@include("partials/head-css.html")

        <script>

            document.addEventListener('DOMContentLoaded', function () {
                                        
                                
                                window.vueApp({
                                    data() {
                                        return {
                                            candidateActive:null,
                                            loading: true,

                                        }
                                    },
                                    computed: {
                                        isUserLogger() {
                                            return !!localStorage.getItem('user');
                                        },
                                        userLogger() {
                                            const user = localStorage.getItem('user')
                                            return user ? JSON.parse(user) : null;
                                        },
                                        userCandidate() {
                                            const candidate = localStorage.getItem('candidate')
                                            return candidate ? JSON.parse(candidate) : null;
                                        },
                                        
                                        userCandidateCheckStatus() {
                                            const candidateStatusCheck = localStorage.getItem('candidateStatusCheck')
                                            return candidateStatusCheck ? JSON.parse(candidateStatusCheck) : null;
                                        }  
                                    },
                                    methods: {
                                        logout() {
                                            localStorage.clear();
                                            window.location.reload();
                                            window.location.href = '/sign-in.html';
                                        },
                                        async getCandidate() {
                                            this.loading = true;
                                            const userLogger = this.userLogger;
                                            if (!userLogger) return;
                                            try {
                                                const res = await fetch(`https://ypjkbbt6hgjcoi46mdpv5hkjzi0ttivo.lambda-url.us-east-2.on.aws/api/v1/candidate?userId=${userLogger.userId}&pageSize=1&pageNumber=1`);
                                                const data = await res.json();
                                                console.log("getCandidate");
                                                const candidate = data?.data?.data || [];
                                                if (!candidate.length) return;
                                                localStorage.setItem("candidate", JSON.stringify(candidate[0]));
                                                this.candidateActive = candidate[0];
                                                await this.getCandidateCheckStatus(userLogger);
                                            } catch (e) {
                                                // erro silencioso
                                            }finally {
                                                this.loading = false;
                                            }
                                        },
                                        getCandidateCheckStatus() {
                                            // Executa tudo e só retorna no final
                                            const userLogger = this.userLogger;
                                            return new Promise((resolve) => {
                                                if (!userLogger) {
                                                    resolve();
                                                    return;
                                                }
                                                const candidate = JSON.parse(localStorage.getItem("candidate") || "null");
                                                if (!candidate || !candidate.id) {
                                                    resolve();
                                                    return;
                                                }
                                                fetch(`https://ypjkbbt6hgjcoi46mdpv5hkjzi0ttivo.lambda-url.us-east-2.on.aws/api/v1/candidate/${candidate.id}/check`)
                                                    .then(res => res.json())
                                                    .then(data => {
                                                        console.log("getCandidateCheckStatus");
                                                        const candidateStatus = data?.data || null;
                                                        localStorage.setItem("candidateStatusCheck", JSON.stringify(candidateStatus));
                                                        resolve();
                                                    })
                                                    .catch(() => resolve());
                                            });
                                        },
                                    },
                                    mounted() {
                                        // localStorage.setItem('user', JSON.stringify({name: 'John Doe', email: 'ma@mail.com'}));
                                        this.getCandidate()
                                    }
                                }).mount('#job-list-vue-app-8');
            
                            });
            </script>

    </head>

    @@include("partials/body.html")

        <!-- Begin page -->
        <div>

            @@include("partials/topbar.html")

            <div class="main-content" id="job-list-vue-app-8">

                <div class="page-content">

                    @@include("partials/page-title.html",{"pagetitle":"Perfil","title":"Meu Perfil"})

                    <!-- START PROFILE -->
                    <section class="section">
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="card profile-sidebar me-lg-4">
                                        <div class="card-body p-4">
                                            <div class="text-center pb-4 border-bottom">
                                                <!-- candidateActive?.photoUrl ||  -->
                                                <img :src="candidateActive?.photoUrl || 'assets/images/profile.jpg'" alt=""
                                                    class="avatar-lg img-thumbnail rounded-circle mb-4" />
                                                <h5 class="mb-0">{{ candidateActive?.name || 'Nome não informado' }}</h5>
                                                <p class="text-muted">{{ userLogger?.email }}</p>
                                                <ul class="list-inline d-flex justify-content-center align-items-center ">
                                                    <li class="list-inline-item text-warning fs-19">
                                                        <i class="mdi mdi-star"></i>
                                                        <i class="mdi mdi-star"></i>
                                                        <i class="mdi mdi-star"></i>
                                                        <i class="mdi mdi-star"></i>
                                                        <i class="mdi mdi-star-half-full"></i>
                                                    </li>
                                                </ul>
                                                <ul class="candidate-detail-social-menu list-inline mb-0">
                                                    <li class="list-inline-item" v-if="candidateActive?.emails?.length">
                                                        <a :href="'mailto:' + candidateActive.emails[0]" class="social-link rounded-3 btn-soft-primary">
                                                            <i class="uil uil-envelope"></i>
                                                        </a>
                                                    </li>
                                                    <li class="list-inline-item" v-if="candidateActive?.phoneNumbers?.length">
                                                        <a :href="'https://wa.me/' + candidateActive.phoneNumbers[0].number.replace(/\D/g, '')" target="_blank" class="social-link rounded-3 btn-soft-success">
                                                            <i class="uil uil-whatsapp"></i>
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                            <!--end profile-->
                                            <div class="mt-4 border-bottom pb-4" v-if="candidateActive?.cvUrl">
                                                <h5 class="fs-17 fw-bold mb-3">Documentos</h5>
                                                <ul class="profile-document list-unstyled mb-0">
                                                    <li>
                                                        <div class="profile-document-list d-flex align-items-center mt-4 ">
                                                            <div class="icon flex-shrink-0">
                                                                <i class="uil uil-file"></i>
                                                            </div>
                                                            <div class="ms-3">
                                                                <h6 class="fs-16 mb-0">Currículo.pdf</h6>
                                                                <p class="text-muted mb-0">Arquivo</p>
                                                            </div>
                                                            <div class="ms-auto">
                                                                <a :href="candidateActive.cvUrl" target="_blank" class="fs-20 text-muted">
                                                                    <i class="uil uil-import"></i>
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                            <!--end document-->
                                            <div class="mt-4">
                                                <h5 class="fs-17 fw-bold mb-3">Contatos</h5>
                                                <div class="profile-contact">
                                                    <ul class="list-unstyled mb-0">
                                                        <li v-if="candidateActive?.emails?.length">
                                                            <div class="d-flex">
                                                                <label>Email</label>
                                                                <div>
                                                                    <p class="text-muted text-break mb-0">
                                                                        {{ candidateActive.emails[0] }}
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </li>
                                                        <li v-if="candidateActive?.phoneNumbers?.length">
                                                            <div class="d-flex">
                                                                <label>Telefone</label>
                                                                <div>
                                                                    <p class="text-muted mb-0">{{ candidateActive.phoneNumbers[0].number }}</p>
                                                                </div>
                                                            </div>
                                                        </li>
                                                        <li v-if="candidateActive?.location">
                                                            <div class="d-flex">
                                                                <label>Localização</label>
                                                                <div>
                                                                    <p class="text-muted mb-0">{{ candidateActive.location }}</p>
                                                                </div>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <!--end contact-details-->
                                        </div>
                                        <!--end card-body-->
                                    </div>
                                    <!--end profile-sidebar-->
                                </div>
                                <!--end col-->
                                <div class="col-lg-8">
                                    <div class="card profile-content-page mt-4 mt-lg-0">
                                        <ul class="profile-content-nav nav nav-pills border-bottom mb-4" id="pills-tab"
                                                role="tablist">
                                                <li class="nav-item" role="presentation">
                                                    <button class="nav-link active" id="overview-tab" data-bs-toggle="pill"
                                                        data-bs-target="#overview" type="button" role="tab" aria-controls="overview"
                                                        aria-selected="true">
                                                        Visão Geral
                                                    </button>
                                                </li>
                                                <li class="nav-item" role="presentation">
                                                    <button class="nav-link" id="settings-tab" data-bs-toggle="pill"
                                                        data-bs-target="#settings" type="button" role="tab" aria-controls="settings"
                                                        aria-selected="false">
                                                        Configurações
                                                    </button>
                                                </li>
                                            </ul>
                                        <div class="card-body p-4">
                                            <!-- <pre>{{candidateActive}}</pre> -->
                                           
                                        <div class="card-body p-4">
                                            <div class="tab-content" id="pills-tabContent">
                                                <div class="tab-pane fade show active" id="overview" role="tabpanel"
                                                    aria-labelledby="overview-tab">

                                                    <div>
                                                        <h5 class="fs-18 fw-bold">Sobre</h5>
                                                        <p class="text-muted mt-4">
                                                            {{ candidateActive?.description || candidateActive?.summary || 'Sem descrição disponível.' }}
                                                        </p>
                                                    </div>

                                                    <div class="candidate-education-details mt-4" v-if="candidateActive?.education?.length">
                                                        <h6 class="fs-18 fw-bold mb-0">Educação</h6>
                                                        <div v-for="(edu, idx) in candidateActive.education" :key="idx" class="candidate-education-content mt-4 d-flex">
                                                            <div class="circle flex-shrink-0 primary-bg-subtle">
                                                                <strong class="text-primary">{{ edu.course ? edu.course.charAt(0).toUpperCase() : 'E' }}</strong>
                                                            </div>
                                                            <div class="ms-4">
                                                                <h6 class="fs-16 mb-1">{{ edu.course }}</h6>
                                                                <p class="mb-2 text-muted">
                                                                    {{ edu.institute }} <span v-if="edu.location">- {{ edu.location }}</span>
                                                                    <span v-if="edu.period">({{ edu.period }})</span>
                                                                </p>
                                                                <!-- <p class="text-muted">
                                                               
                                                                </p> -->
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="candidate-education-details mt-4" v-if="candidateActive?.experiences?.length">
                                                        <h6 class="fs-18 fw-bold mb-0">Experiências</h6>
                                                        <div v-for="(exp, idx) in candidateActive.experiences" :key="idx" class="candidate-education-content mt-4 d-flex">
                                                            <div class="circle flex-shrink-0 primary-bg-subtle">
                                                                <strong class="text-primary">{{ exp.position ? exp.position.charAt(0).toUpperCase() : 'E' }}</strong>
                                                            </div>
                                                            <div class="ms-4">
                                                                <h6 class="fs-16 mb-1">{{ exp.position }}</h6>
                                                                <p class="mb-2 text-muted">{{ exp.company }} <span v-if="exp.period">- {{ exp.period }}</span></p>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="mt-4" v-if="candidateActive?.skills?.length">
                                                        <h5 class="fs-18 fw-bold">Habilidades</h5>
                                                        <span v-for="(skill, idx) in candidateActive.skills" :key="idx"
                                                            class="badge fs-13 bg-primary-subtle text-primary mt-2 me-2">{{ skill }}</span>
                                                    </div>

                                                    <div class="mt-4" v-if="candidateActive?.languages?.length">
                                                        <h5 class="fs-18 fw-bold">Idiomas falados</h5>
                                                        <span v-for="(lang, idx) in candidateActive.languages" :key="idx"
                                                            class="badge fs-13 bg-success-subtle text-success mt-2 me-2">{{ lang }}</span>
                                                    </div>

                                                    <div class="mt-4" v-if="candidateActive?.location">
                                                        <h5 class="fs-18 fw-bold">Localização</h5>
                                                        <span class="badge fs-13 bg-primary text-white mt-2 me-2">{{ candidateActive.location }}</span>
                                                    </div>

                                                    <div class="mt-4" v-if="candidateActive?.cvUrl">
                                                        <h5 class="fs-18 fw-bold">Currículo</h5>
                                                        <a :href="candidateActive.cvUrl" target="_blank" class="btn btn-outline-primary">
                                                            <i class="uil uil-file-alt me-2"></i>Ver Currículo
                                                        </a>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="settings" role="tabpanel" aria-labelledby="settings-tab">
                                                    <form action="#">
                                                        <div>
                                                            <h5 class="fs-17 fw-semibold mb-3 mb-0">Minha Conta</h5>
                                                            <div class="text-center">
                                                                <div class="mb-4 profile-user">
                                                                    <img src="assets/images/profile.jpg" class="rounded-circle img-thumbnail profile-img" id="profile-img" alt="">
                                                                    <div class="p-0 rounded-circle profile-photo-edit">
                                                                        <input id="profile-img-file-input" type="file" class="profile-img-file-input">
                                                                        <label for="profile-img-file-input" class="profile-photo-edit avatar-xs">
                                                                            <i class="uil uil-edit"></i>
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="firstName" class="form-label">Nome</label>
                                                                        <input type="text" class="form-control" id="firstName"
                                                                            :value="userLogger?.email.split('@')[0]" />

                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="lastName" class="form-label">Sobrenome</label>
                                                                        <input type="text" class="form-control" id="lastName"
                                                                            :value="userLogger?.email.split('@')[0]" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="choices-single-categories" class="form-label">Tipo de Conta</label>
                                                                        <select class="form-select" data-trigger
                                                                            name="choices-single-categories"
                                                                            id="choices-single-categories"
                                                                            aria-label="Default select example">
                                                                            <option value="4">Contabilidade</option>
                                                                            <option value="1">TI & Software</option>
                                                                            <option value="3">Marketing</option>
                                                                            <option value="5">Bancário</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="email" class="form-label">Email</label>
                                                                        <input type="text" class="form-control" id="email"
                                                                            :value="userLogger?.email" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                            </div>
                                                            <!--end row-->
                                                        </div>
                                                        <!--end account-->
                                                        <div class="mt-4">
                                                            <h5 class="fs-17 fw-semibold mb-3">Perfil</h5>
                                                            <div class="row">
                                                                <div class="col-lg-12">
                                                                    <div class="mb-3">
                                                                        <label for="exampleFormControlTextarea1"
                                                                            class="form-label">Apresente-se</label>
                                                                        <textarea class="form-control" id="exampleFormControlTextarea1"
                                                                            rows="5">Desenvolvedor com mais de 5 anos de experiência atuando nos setores público e privado. Diplomático, comunicativo e habilidoso em gerenciar situações sensíveis. Altamente organizado, autodidata e proficiente em informática. Busca aumentar os índices de satisfação dos alunos da Universidade Internacional. Bacharel em comunicação.</textarea>
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="languages" class="form-label">Idiomas</label>
                                                                        <input type="text" class="form-control" id="languages"
                                                                            value="Inglês, Alemão, Francês" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="choices-single-location" class="form-label">Localização</label>
                                                                        <select class="form-select" data-trigger
                                                                            name="choices-single-location" id="choices-single-location"
                                                                            aria-label="Default select example">
                                                                            <option value="ME">Montenegro</option>
                                                                            <option value="MS">Montserrat</option>
                                                                            <option value="MA">Marrocos</option>
                                                                            <option value="MZ">Moçambique</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-12">
                                                                    <div class="mb-3">
                                                                        <label for="attachmentscv" class="form-label">Anexar CV</label>
                                                                        <input class="form-control" type="file" id="attachmentscv" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                            </div>
                                                            <!--end row-->
                                                        </div>
                                                        <!--end profile-->
                                                        <div class="mt-4">
                                                            <h5 class="fs-17 fw-semibold mb-3">Redes Sociais</h5>
                                                            <div class="row">
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="facebook" class="form-label">Facebook</label>
                                                                        <input type="text" class="form-control" id="facebook"
                                                                            value="https://www.facebook.com" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="twitter" class="form-label">Twitter</label>
                                                                        <input type="text" class="form-control" id="twitter"
                                                                            value="https://www.twitter.com" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="linkedin" class="form-label">Linkedin</label>
                                                                        <input type="text" class="form-control" id="linkedin"
                                                                            value="https://www.linkedin.com" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="whatsapp" class="form-label">Whatsapp</label>
                                                                        <input type="text" class="form-control" id="whatsapp"
                                                                            value="https://www.whatsapp.com" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                            </div>
                                                            <!--end row-->
                                                        </div>
                                                        <!--end socia-media-->
                                                        <div class="mt-4">
                                                            <h5 class="fs-17 fw-semibold mb-3 mb-3">
                                                                Alterar Senha
                                                            </h5>
                                                            <div class="row">
                                                                <div class="col-lg-12">
                                                                    <div class="mb-3">
                                                                        <label for="current-password-input" class="form-label">Senha Atual</label>
                                                                        <input type="password" class="form-control"
                                                                            placeholder="Digite a senha atual"
                                                                            id="current-password-input" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="new-password-input" class="form-label">Nova Senha</label>
                                                                        <input type="password" class="form-control"
                                                                            placeholder="Digite a nova senha"
                                                                            id="new-password-input" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-6">
                                                                    <div class="mb-3">
                                                                        <label for="confirm-password-input" class="form-label">Confirmar Senha</label>
                                                                        <input type="password" class="form-control"
                                                                            placeholder="Confirme a nova senha"
                                                                            id="confirm-password-input" />
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                                <div class="col-lg-12">
                                                                    <div class="form-check">
                                                                        <input class="form-check-input" type="checkbox" value=""
                                                                            id="verification" />
                                                                        <label class="form-check-label" for="verification">
                                                                            Ativar verificação em duas etapas por email
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <!--end col-->
                                                            </div>
                                                            <!--end row-->
                                                        </div>
                                                        <!--end Change-password-->
                                                        <div class="mt-4 text-end">
                                                            <a href="javascript:void(0)" class="btn btn-primary">Atualizar</a>
                                                        </div>
                                                    </form>
                                                    <!--end form-->
                                                </div>
                                                <!--end tab-pane-->
                                            </div>
                                            <!--end tab-content-->
                                        </div>
                                        <!--end card-body-->
                                    </div>
                                    <!--end profile-content-page-->
                                </div>
                                <!--end col-->
                            </div>
                            <!--end row-->
                        </div>
                        <!--end container-->
                    </section>
                    <!-- END PROFILE -->

                </div>
                <!-- End Page-content -->

                @@include("partials/footer.html")

                @@include("partials/switcher.html")
            </div>
            <!-- end main content-->

        </div>
        <!-- END layout-wrapper -->

        @@include("partials/vendor-scripts.html")

        <!-- Choice Js -->
        <script src="assets/libs/choices.js/public/assets/scripts/choices.min.js"></script>

        <!-- Job-list Init Js -->
        <script src="assets/js/pages/job-list.init.js"></script>

        <!-- Switcher Js -->
        <script src="assets/js/pages/switcher.init.js"></script>

        <!-- App Js -->
        <script src="assets/js/app.js"></script>

    </body>
</html>